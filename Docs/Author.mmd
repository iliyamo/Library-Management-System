flowchart TD
    %% ساخت نویسنده جدید
    A[درخواست ایجاد نویسنده] --> B[POST /api/v1/authors]
    B --> C[بررسی JWT Middleware]
    C -->|بدون توکن| D[خطای 401 - فقدان توکن]
    C -->|توکن نامعتبر| E[خطای 401 - توکن نامعتبر]
    C -->|توکن معتبر| F[بررسی Rate Limit]
    F -->|بیش از حد| G[خطای 429 - تعداد درخواست زیاد]
    F -->|مجاز| H{بررسی اعتبار داده‌ها}
    H -->|نامعتبر| I[خطای 400 - درخواست نامعتبر]
    H -->|معتبر| J[تبدیل تاریخ تولد]
    J -->|فرمت نادرست| K[خطای 400 - فرمت تاریخ نادرست]
    J -->|فرمت درست| L[بررسی تکراری بودن نویسنده]
    L -->|تکراری| M[خطای 409 - نویسنده موجود]
    L -->|جدید| N[ایجاد Author Object]
    N --> O[ذخیره در دیتابیس]
    O -->|خطا| P[خطای 500 - ثبت ناموفق]
    O -->|موفق| Q[پاسخ 201 - نویسنده ایجاد شد]

    %% دریافت همه نویسندگان
    R[درخواست لیست نویسندگان] --> S[GET /api/v1/authors]
    S --> T[بررسی JWT Middleware]
    T -->|بدون توکن| U[خطای 401 - فقدان توکن]
    T -->|توکن نامعتبر| V[خطای 401 - توکن نامعتبر]
    T -->|توکن معتبر| W[بررسی Rate Limit]
    W -->|بیش از حد| X[خطای 429 - تعداد درخواست زیاد]
    W -->|مجاز| Y{بررسی پارامتر جستجو}
    Y -->|بدون جستجو| Z[دریافت همه نویسندگان از DB]
    Y -->|با جستجو| AA[بررسی Redis Cache]
    AA -->|موجود در کش| BB[بازگشت از Cache]
    AA -->|غیرموجود| CC[Full-text Search در DB]
    CC --> DD[ذخیره نتیجه در Redis - 30 ثانیه]
    DD --> EE[بازگشت نتایج با Pagination]
    Z --> FF[بازگشت لیست کامل]

    %% دریافت نویسنده با ID
    GG[درخواست نویسنده خاص] --> HH[GET /api/v1/authors/:id]
    HH --> II[بررسی JWT Middleware]
    II -->|بدون توکن| JJ[خطای 401 - فقدان توکن]
    II -->|توکن نامعتبر| KK[خطای 401 - توکن نامعتبر]
    II -->|توکن معتبر| LL[بررسی Rate Limit]
    LL -->|بیش از حد| MM[خطای 429 - تعداد درخواست زیاد]
    LL -->|مجاز| NN{بررسی اعتبار ID}
    NN -->|نامعتبر| OO[خطای 400 - شناسه نامعتبر]
    NN -->|معتبر| PP[جستجوی نویسنده در DB]
    PP -->|یافت نشد| QQ[خطای 404 - نویسنده یافت نشد]
    PP -->|یافت شد| RR[بازگشت اطلاعات نویسنده]

    %% بروزرسانی نویسنده
    SS[درخواست بروزرسانی نویسنده] --> TT[PUT /api/v1/authors/:id]
    TT --> UU[بررسی JWT Middleware]
    UU -->|بدون توکن| VV[خطای 401 - فقدان توکن]
    UU -->|توکن نامعتبر| WW[خطای 401 - توکن نامعتبر]
    UU -->|توکن معتبر| XX[بررسی Rate Limit]
    XX -->|بیش از حد| YY[خطای 429 - تعداد درخواست زیاد]
    XX -->|مجاز| ZZ{بررسی اعتبار ID}
    ZZ -->|نامعتبر| AAA[خطای 400 - شناسه نامعتبر]
    ZZ -->|معتبر| BBB{بررسی اعتبار داده‌ها}
    BBB -->|نامعتبر| CCC[خطای 400 - درخواست نامعتبر]
    BBB -->|معتبر| DDD[تبدیل تاریخ تولد]
    DDD -->|فرمت نادرست| EEE[خطای 400 - فرمت تاریخ نادرست]
    DDD -->|فرمت درست| FFF[بروزرسانی در DB]
    FFF -->|ناموفق| GGG[خطای 404 - نویسنده یافت نشد]
    FFF -->|موفق| HHH[پاسخ 200 - بروزرسانی موفق]

    %% حذف نویسنده
    III[درخواست حذف نویسنده] --> JJJ[DELETE /api/v1/authors/:id]
    JJJ --> KKK[بررسی JWT Middleware]
    KKK -->|بدون توکن| LLL[خطای 401 - فقدان توکن]
    KKK -->|توکن نامعتبر| MMM[خطای 401 - توکن نامعتبر]
    KKK -->|توکن معتبر| NNN[بررسی Rate Limit]
    NNN -->|بیش از حد| OOO[خطای 429 - تعداد درخواست زیاد]
    NNN -->|مجاز| PPP{بررسی اعتبار ID}
    PPP -->|نامعتبر| QQQ[خطای 400 - شناسه نامعتبر]
    PPP -->|معتبر| RRR[حذف از دیتابیس]
    RRR -->|ناموفق| SSS[خطای 404 - نویسنده یافت نشد]
    RRR -->|موفق| TTT[پاسخ 200 - حذف موفق]

    %% استایل‌ها
    classDef successNode fill:#d4edda,stroke:#155724,color:#155724
    classDef errorNode fill:#f8d7da,stroke:#721c24,color:#721c24
    classDef processNode fill:#cce5ff,stroke:#004085,color:#004085
    classDef authNode fill:#fff3cd,stroke:#856404,color:#856404
    classDef cacheNode fill:#e2e3e5,stroke:#383d41,color:#383d41

    class Q,BB,EE,FF,RR,HHH,TTT successNode
    class D,E,G,I,K,M,P,U,V,X,JJ,KK,MM,OO,QQ,VV,WW,YY,AAA,CCC,EEE,GGG,LLL,MMM,OOO,QQQ,SSS errorNode
    class H,J,L,N,O,Y,CC,DD,NN,PP,ZZ,BBB,DDD,FFF,PPP,RRR processNode
    class C,F,T,W,II,LL,UU,XX,KKK,NNN authNode
    class AA,DD cacheNode